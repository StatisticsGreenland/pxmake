---
title: "micromake"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{micromake}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

Install.
```{r, eval= FALSE}
devtools::install_github('StatisticsGreenland/pxmake',
                         ref = '176-mikrodata'
                         )
```

Load libraries.

```{r setup, message=FALSE}
library(pxmake)
library(dplyr)
```

Open data.

```{r}
df <- 
  readRDS("micro.rds") %>% 
  select(taar, civst, civdto, kirke)

df
```

Create a metadata template.

```{r}
micro_metadata <- 'micro.xlsx' 
make_template(data_df = df, 
              languages = c("en"),
              time_variable = "taar",
              figures_variable = "n", # Important, figures_variable *has* to be "n"
              out_path = micro_metadata
              )
```

The template can be used as is, or it can be edited in Excel to fill in more metadata. Either way, run `micromake` to create the px-files.

```{r}
micromake(data_df = df, 
          metadata_path = micro_metadata,
          out_dir = getwd()
          )
```

The px-files can be found in `out_dir` which in this example is the working directory.
