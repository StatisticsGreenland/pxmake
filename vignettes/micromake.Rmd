---
title: "micromake"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{micromake}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

Read data set
```{r setup}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(pxmake)
library(tidyverse)
```

Open dataset 
```{r}
df <- 
  read_rds("micro.rds") %>% 
  select(taar, civst, civdto, kirke)

df
```

Create a metadata template.

```{r}
micro_metadata <- 'micro.xlsx' 
make_template(data_df = df, 
              languages = c("en"),
              time_variable = "taar",
              out_path = micro_metadata
              )
```

Open the template in Excel and fill in the metadata.

```{r}
micromake(data_df = df, 
          metadata_path = micro_metadata,
          out_dir = getwd()
          )
```
